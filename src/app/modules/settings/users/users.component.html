<div
  class="sm:absolute sm:inset-0 flex flex-col flex-auto min-w-0 sm:overflow-hidden bg-card dark:bg-transparent"
>
  <!-- Alert -->
  <div class="ml-4 w-80">
      <fuse-alert
        class="mt-8 -mb-4"
        *ngIf="showAlert"
        [appearance]="'outline'"
        [showIcon]="true"
        [type]="alert.type"
        [@shake]="alert.type === 'error'"
      >
        {{ alert.message }}
      </fuse-alert>
  </div>
  <!-- Header -->
  <div
    class="relative flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between py-8 px-6 md:px-8 border-b"
  >
    <!-- Loader -->

    <!-- Title -->
    <div>
      <div class="flex flex-auto items-center min-w-0">
        <mat-icon class="icon-size-10" svgIcon="heroicons_outline:user">
        </mat-icon>
        <div class="flex flex-col min-w-0 ml-4">
          <ng-container>
            <div
              class="text-2xl md:text-3xl font-semibold tracking-tight leading-0 md:leading-snug truncate"
            >
              Users
            </div>
          </ng-container>
          <div class="flex items-center">
            <div class="ml-1.0 leading-0 truncate text-secondary">
              Manage users and permissions
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="flex shrink-0 items-center mt-6 sm:mt-0 sm:ml-4">
      <mat-form-field
        class="fuse-mat-dense fuse-mat-no-subscript fuse-mat-rounded min-w-64"
      >
        <mat-icon
          class="icon-size-5"
          matPrefix
          [svgIcon]="'heroicons_solid:search'"
        >
        </mat-icon>
        <input
          matInput
          [autocomplete]="'off'"
          [placeholder]="'Search User'"
          [(ngModel)]="searchTextForModerator"
          [ngModelOptions]="{ standalone: true }"
        />
      </mat-form-field>
      <button
        class="ml-4"
        mat-flat-button
        [color]="'primary'"
        [routerLink]="['add-user']"
      >
        <mat-icon [svgIcon]="'heroicons_outline:plus'"></mat-icon>
        <span class="ml-2 mr-1">Create new user</span>
      </button>
      <button (click)="back()" class="ml-4" mat-flat-button [color]="'accent'">
        <mat-icon [svgIcon]="'heroicons_outline:arrow-left'"></mat-icon>
        <span class="ml-2 mr-1">Back</span>
      </button>
    </div>
  </div>

  <!-- User table list-->
  <div class="flex flex-auto overflow-hidden">
    <!-- Users list -->
    <div
      class="flex flex-col flex-auto sm:mb-18 overflow-hidden sm:overflow-y-auto"
    >
      <div class="grid">
        <table
          *ngIf="userList.length > 0"
          mat-table
          [dataSource]="dataSource"
          class="mat-elevation-z8"
        >
          <!-- Picture column-->
          <ng-container matColumnDef="Picture">
            <th mat-header-cell *matHeaderCellDef>Picture</th>
            <td mat-cell *matCellDef="let element">
              <div
                class="relative flex flex-0 items-center justify-center w-12 h-12 mr-6 rounded-full overflow-hidden border"
              >
                <img
                  class="w-12"
                  *ngIf="element.picture"
                  [src]="element.picture"
                />
                <img
                  class="w-12"
                  *ngIf="element.picture == null"
                  src="../../../assets/images/avatars/nopicture.png"
                />
              </div>
            </td>
          </ng-container>

          <!-- Username column-->
          <ng-container matColumnDef="UserName">
            <th mat-header-cell *matHeaderCellDef>UserName</th>
            <td mat-cell *matCellDef="let element">
              {{ element.userName }}
            </td>
          </ng-container>

          <!-- Name + lastname Column -->
          <ng-container matColumnDef="Name">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let element">
              {{ element.name + " " + element.lastName }}
            </td>
          </ng-container>

          <!-- Email Column -->
          <ng-container matColumnDef="Email">
            <th mat-header-cell *matHeaderCellDef>Email</th>
            <td mat-cell *matCellDef="let element">
              {{ element.email }}
            </td>
          </ng-container>

          <!-- Is Active Column -->
          <ng-container matColumnDef="IsActive">
            <th mat-header-cell *matHeaderCellDef>Is Active</th>
            <td mat-cell *matCellDef="let element">
              <ng-container *ngIf="element.active">
                <mat-icon
                  class="text-green-400 icon-size-6"
                  [svgIcon]="'heroicons_solid:check'"
                >
                </mat-icon>
              </ng-container>
              <ng-container *ngIf="!element.active">
                <mat-icon
                  class="text-red-400 icon-size-5"
                  [svgIcon]="'heroicons_solid:x'"
                >
                </mat-icon>
              </ng-container>
            </td>
          </ng-container>

          <!-- Last logged in Column -->
          <ng-container matColumnDef="LastLoginTime">
            <th mat-header-cell *matHeaderCellDef>Last Logged In</th>
            <td mat-cell *matCellDef="let element">
              {{ element.lastLoginTime | date: "dd/MM/yyyy" }}
            </td>
          </ng-container>

          <!-- Drop down actions -->
          <ng-container matColumnDef="Action">
            <th mat-header-cell *matHeaderCellDef>Action</th>
            <td mat-cell *matCellDef="let element">
              <div class="hidden sm:block">
                <button
                  class="min-w-10 min-h-7 h-7 px-2 leading-6"
                  mat-stroked-button
                  [matMenuTriggerFor]="summaryMenu"
                >
                  <mat-icon
                    class="icon-size-5"
                    [svgIcon]="'heroicons_solid:chevron-down'"
                  >
                  </mat-icon>
                </button>

                <mat-menu #summaryMenu="matMenu">
                  <button
                    mat-menu-item
                    [routerLink]="['edit-user', element.userId]"
                  >
                    <mat-icon svgIcon="heroicons_outline:pencil-alt">
                    </mat-icon>
                    <span>Edit</span>
                  </button>
                  <button
                    mat-menu-item
                    (click)="deleteSelectedUser(element.userId)"
                  >
                    <mat-icon svgIcon="heroicons_outline:user-remove">
                    </mat-icon>
                    <span>Delete</span>
                  </button>
                  <ng-container *ngIf="!element.active">
                    <button
                      mat-menu-item
                      (click)="ngActivateDeactivateUser(element)"
                    >
                      <mat-icon
                        class="text-green-400"
                        svgIcon="heroicons_outline:check"
                      >
                      </mat-icon>
                      <span>Activate</span>
                    </button>
                  </ng-container>
                  <ng-container *ngIf="element.active">
                    <button
                      mat-menu-item
                      (click)="ngActivateDeactivateUser(element)"
                    >
                      <mat-icon
                        class="text-red-400"
                        svgIcon="heroicons_outline:x-circle"
                      >
                      </mat-icon>
                      <span>De-activate</span>
                    </button>
                  </ng-container>
                </mat-menu>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
        <mat-paginator
          *ngIf="userList.length > 0"
          class="sm:absolute sm:inset-x-0 sm:bottom-0 border-b sm:border-t sm:border-b-0 z-10 bg-gray-50 dark:bg-transparent"
          [pageSizeOptions]="[5, 10, 15, 20]"
          [pageIndex]="userListModel.PageNumber"
          [pageSize]="userListModel.PageSize"
          (page)="getUsersList($event)"
          [length]="userListModel.TotalCount"
          showFirstLastButtons
        >
        </mat-paginator>
      </div>
    </div>
  </div>
</div>
